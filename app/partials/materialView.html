<div ng-include="'/partials/header-new.html'">
</div>

<section class="sectionbg equipment_details material_detail">
  <div class="container-fluid">
    <div class="row">
      <div class="col-12">
        <div class="test-block animated fadeInUp" data-wow-delay="0.2s">
          <div class="d-lg-flex">
            <div class="col-lg-5 pad0 animated fadeIn wow" data-wow-delay="0.6s">
              <div id="equipment_slider" class="carousel slide " data-ride="carousel">
                <div class="carousel-inner">
                  <div class="carousel-item" ng-repeat="slide in vm.matrialData.files.images" ng-class="{active:!$index}">
                    <img class="d-block w-100" ng-src="{{slide.secure_url}}" alt="First slide">
                  </div>
                </div>
                <a class="carousel-control-prev" data-target="#equipment_slider" role="button" data-slide="prev">
                  <img class="img-fluid wobble-horizontal" src="/assets/images/arrow_left.png" alt="arrow_left">
                </a>
                <a class="carousel-control-next" data-target="#equipment_slider" role="button" data-slide="next">
                  <img class="img-fluid wobble-horizontal" src="/assets/images/arrow_right.png" alt="arrow_right">
                </a>
              </div>
            </div>
            <div class="col-lg-7 pad0 animated fadeIn wow" data-wow-delay="0.6s">
              <div class="head-block d-flex align-items-center justify-content-between position-relative">
                <div>
                  <h2 class="headOne">{{vm.matrialData.name}}</h2>
                  <p class="issue-number mb-0 f600">{{vm.matrialData.createdAt | date}}</p>
                </div>
                <ul class="list-inline mat-btn-list">
                  <!-- <li class="list-inline-item">
                    <a href="JavaScript:Void(0);" name="file" ngf-pattern="'image/*'" ngf-multiple="true" ngf-accept="'image/*'" ngf-select ng-model="vm.inputFiles" ngf-change="vm.fileUpdated($files, $event)">Add Images</a>
                  </li> -->
                  <li class="list-inline-item">
                    <a ng-click="vm.editMaterialFunction(1)" href="JavaScript:Void(0);">Edit Material</a>
                  </li>
                  <li class="list-inline-item">
                    <a href="JavaScript:Void(0);">3D Viewer</a>
                  </li>
                </ul>
              </div>
              <div class="row align-items-center mx-4" ng-if="vm.fileNames.length > 0">
                <div class="col-9">
                  <span ng-repeat="f in vm.fileNames ">{{f}}, </span>
                </div>
                <div class="form-group col-3">
                  <div ng-click="vm.editMaterialFunction(2)" class="btn btn_create_issue ripple">Update Image</div>
                </div>
              </div>

              <div class="gray-part">
                <div class="row justify-content-md-center">
                  <div class="col-md-3" ng-repeat="gray_one in gray_box">
                    <img class="d-block m-auto img-fluid" ng-src="{{gray_one.img}}" alt="First slide">
                    <h4 class="text-center">{{gray_one.title}}</h4>
                    <p class="text-center">{{gray_one.value}}
                      <small class="text-muted" ng-if="gray_one.currencyCode">{{gray_one.currencyCode}}</small>
                    </p>
                  </div>
                </div>
              </div>
              <!-- <table id="dataTable" datatable="ng" class="table table-striped table-bordered nowrap" cellspacing="0" width="100%"> -->
              <div class="row m-0 materialViewDataTable">
                <div class="col-12">
                  <table class="table table-striped table-bordered nowrap" datatable="ng" cellspacing="0" width="100%">
                    <thead>
                      <tr>
                        <th style="width: 15%">S.No</th>
                        <th style="width: 20%">Date</th>
                        <th>Material Cost</th>
                        <th>Roofer Cost</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-repeat="rate in vm.matrialData.rateLog">
                        <td>{{$index + 1}}</td>
                        <td>{{rate.date | date}} </td>
                        <td>{{rate.materialCost.value | roundNum: 2}} ({{rate.materialCost.currencyCode}}) </td>
                        <td>{{rate.rooferCost.value | roundNum: 2}} ({{rate.rooferCost.currencyCode}}) </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div class="clearfix"></div>

              <div class="row align-items-center pl-5 pr-5">
                <div class="col-md-6">
                  <p class="red-box-txt f700 ng-binding">{{vm.matrialData.systemTag}}</p>
                  <p class="next-maint">Next Maintenance On Dec 25, 2017</p>
                </div>
                <div class="col-md-6 text-right">
                  <h4 class="simon-txt">Added by {{vm.matrialData.providerData.updatedBy.name}}</h4>
                  <p class="mb-0">Last Updated On {{vm.matrialData.updatedAt | date}}</p>
                </div>
              </div>
              <div class="space30"></div>
            </div>
          </div>
        </div>


      </div>
    </div>
  </div>
</section>

<div class="modal fade popup2 material_modal" data-easein="slideUpBigIn" id="todo_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <div class="d-flex align-items-center justify-content-between w-100">
          <h5 class="modal-title f500 txtwhite">Edit Material</h5>
        </div>
      </div>
      <div class="modal-body pad0">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="home-tab" data-toggle="tab" data-target="#material1" role="tab" aria-controls="home" aria-selected="true">Material Detail</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="profile-tab" data-toggle="tab" data-target="#dcp1" role="tab" aria-controls="profile" aria-selected="false">Set Cost</a>
          </li>
        </ul>
        <div class="tab-content" id="myTabContent">
          <div class="tab-pane fade show active" id="material1" role="tabpanel" aria-labelledby="home-tab">
            <div class="d-md-flex">
              <div class="col-lg-12 pad0">
                <div class="issue_form">
                  <div class="f_block">
                    <p class="fsize18 f500 txtgrey c_space mb-2">Material Name</p>
                    <input type="text" class="form-control animated zoomIn wow" ng-model="vm.editMaterial.name" maxlength="100" ng-minlength="2"
                      required>
                  </div>
                  <div class="f_block">
                    <p class="fsize18 f500 txtgrey c_space mb-2 mt-4">Unit</p>
                    <div class="dropdown position-relative d-inline-block ml-auto taskdrop w-100">
                      <button class="btn selectbox dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span ng-if="vm.selectedUnit">{{vm.selectedUnit}}</span>
                        <span ng-if="!vm.selectedUnit">Please select Unit</span>
                      </button>
                      <ul class="dropdown-menu avail_option">
                        <li ng-repeat="unit in vm.mUnits" ng-click="vm.unitSelect(unit)">{{unit.name}}</li>
                      </ul>
                    </div>
                  </div>
                  <div class="f_block">
                    <p class="fsize18 f500 txtgrey c_space mb-2 mt-4">Currency</p>
                    <select ui-select2 ng-model="vm.editMaterial.currency" class="form-control" ng-change="vm.showConversionRate(vm.currentCurrency, vm.editMaterial.currency)">
                      <option ng-selected="currency.cc == vm.editMaterial.currency" ng-repeat="currency in vm.currencies" value="{{currency.cc}}">{{currency.cc}} - {{currency.name}}</option>
                    </select>
                  </div>
                  <div class="f_block">
                    <p class="fsize18 f500 txtgrey c_space mb-2 mt-4">Conversion Factor</p>
                    <span class="form-control animated zoomIn wow">{{vm.editMaterial.conversionFactor | roundNum:2}}</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer align-items-center">
              <div>
                <button type="button" class="btn btn_create_issue ripple" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn_create_issue ripple" data-ng-click="vm.tabChange(1)">Next</button>
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="dcp1" role="tabpanel" aria-labelledby="profile-tab">
            <div class="d-md-flex">
              <div class="col-lg-12 pad0">
                <div class="issue_form">
                  <div class="f_block">
                    <p class="fsize18 f500 txtgrey c_space mb-2 mt-4">Material Cost ({{vm.editMaterial.currency}})</p>
                    <input type="number" class="form-control animated zoomIn wow" ng-change="vm.changeCost(vm.editMaterial.currentRate.materialCost.value)"
                      ng-model="vm.editMaterial.currentRate.materialCost.value" required />
                  </div>
                  <div class="f_block">
                    <p class="fsize18 f500 txtgrey c_space mb-2 mt-4">Worker Cost ({{vm.editMaterial.currency}})</p>
                    <input type="number" class="form-control animated zoomIn wow" ng-change="vm.changeCost(vm.editMaterial.currentRate.rooferCost.value)"
                      ng-model="vm.editMaterial.currentRate.rooferCost.value" required />
                  </div>
                  <div class="f_block">
                    <p class="fsize18 f500 txtgrey c_space mb-2 mt-4">Conversion Factor</p>
                    <span class="form-control animated zoomIn wow">{{vm.editMaterial.conversionFactor | roundNum:2}}</span>
                  </div>
                  <!-- <div class="f_block">
                    <p class="fsize18 f500 txtgrey c_space mb-2 mt-4">Actual Material Cost ({{vm.currentCurrency}})</p>
                    <span class="form-control animated zoomIn wow">{{vm.editMaterial.currentRate.materialCost.value | convertCurrency:vm.editMaterial.conversionFactor | roundNum:2}}</span>
                  </div>
                  <div class="f_block">
                    <p class="fsize18 f500 txtgrey c_space mb-2 mt-4">Actual Roofer Cost ({{vm.currentCurrency}})</p>
                    <span class="form-control animated zoomIn wow">{{vm.editMaterial.currentRate.rooferCost.value | convertCurrency:vm.editMaterial.conversionFactor | roundNum:2}}</span>
                  </div> -->
                  <div class="f_block mt-4" ng-if="vm.editMaterial.files.length > 0">
                    <div class="row">
                      <div class="col-md-2 thumbImg p-1" ng-repeat="files in vm.editMaterial.files">
                        <img ng-src="{{files.secure_url}}" alt="">
                        <span class="removeImg" ng-click="vm.removeImg($index)">
                          <i class="fas fa-times-circle"></i>
                        </span>
                      </div>
                    </div>
                  </div>
                  <div class="f_block">
                    <div class="btn btn_create_issue ripple  mt-4" ngf-select ng-model="vm.inputFiles" ngf-change="vm.fileUpdated($files, $event)"
                      name="file" ngf-pattern="'image/*'" ngf-multiple="true" ngf-accept="'image/*'">Upload Images</div>
                    <div>
                      <span ng-repeat="filename in vm.fileNames">{{filename}}, </span>
                    </div>
                  </div>

                </div>
              </div>
            </div>
            <div class="modal-footer align-items-center">
              <div>
                <button type="button" class="btn btn_create_issue ripple" data-ng-click="vm.tabChange(0)">Previous</button>
                <button type="button" class="btn btn_create_issue ripple" ng-click="vm.editMaterialFunction(2)">Update</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- <div class="modal-footer align-items-center">
        <div>
          <button type="button" class="btn btn_create_issue ripple" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn_create_issue ripple" ng-if="vm.checkTabClass() == 'material'" data-toggle="tab" data-target="#dcp1" role="tab">Next</button>
          <button type="button" class="btn btn_create_issue ripple" ng-if="vm.checkTabClass() == 'dcp'" data-toggle="tab" data-target="#material1" role="tab">Previous</button>
          <button type="button" class="btn btn_create_issue ripple" ng-if="vm.checkTabClass() == 'dcp'">Create</button>
        </div>
      </div> -->
    </div>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function () {
    $('#dataTable').DataTable({
      /* "searching": false,
      "paging": true,
      "info": true,
      "lengthChange": true,
      "sDom": 'Rfrtlip',
      "pageLength": 4,
      "oLanguage": { "sSearch": "" }, */
      oPaginate: { sFirst: "First", sLast: "Last", sNext: ">", sPrevious: "<" }
    });
  });
</script>